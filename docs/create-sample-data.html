---

title: Create Sample Data


keywords: fastai
sidebar: home_sidebar

summary: "This module creates batches of random generated orders and saves that to parquet files using Dask"
description: "This module creates batches of random generated orders and saves that to parquet files using Dask"
nb_path: "01_create-sample-data.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_create-sample-data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="OrderRandomSource" class="doc_header"><code>class</code> <code>OrderRandomSource</code><a href="https://github.com/leosmerling/fraud_poc/tree/master/fraud_poc/data/make_sample_data.py#L44" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>OrderRandomSource</code>(<strong><code>days_ago</code></strong>:<code>int</code>, <strong><code>days_span</code></strong>:<code>int</code>, <strong><code>customer_ids</code></strong>:<code>list</code>, <strong><code>emails</code></strong>:<code>list</code>, <strong><code>email_to_customer</code></strong>:<code>list</code>, <strong><code>ips</code></strong>, <strong><code>email_to_ip</code></strong>:<code>list</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="submit_job" class="doc_header"><code>submit_job</code><a href="https://github.com/leosmerling/fraud_poc/tree/master/fraud_poc/data/make_sample_data.py#L121" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>submit_job</code>(<strong><code>payload</code></strong>:<code>None</code>, <strong><code>context</code></strong>:<code>EventContext</code>, <strong><code>num_batches</code></strong>:<code>int</code>=<em><code>12</code></em>, <strong><code>batch_size</code></strong>:<code>int</code>=<em><code>100000</code></em>, <strong><code>batch_span_days</code></strong>:<code>int</code>=<em><code>30</code></em>, <strong><code>num_customers</code></strong>:<code>int</code>=<em><code>10000</code></em>, <strong><code>num_emails</code></strong>:<code>int</code>=<em><code>10000</code></em>, <strong><code>num_ips</code></strong>:<code>int</code>=<em><code>10000</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_batches" class="doc_header"><code>make_batches</code><a href="https://github.com/leosmerling/fraud_poc/tree/master/fraud_poc/data/make_sample_data.py#L128" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_batches</code>(<strong><code>job</code></strong>:<a href="/fraud_poc/jobs.html#MakeSampleDataJob"><code>MakeSampleDataJob</code></a>, <strong><code>context</code></strong>:<code>EventContext</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span> nbdev_build_lib
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>zsh:1: command not found: nbdev_build_lib
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Test-from-notebook">Test from notebook<a class="anchor-link" href="#Test-from-notebook"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">hopeit.testing.apps</span> <span class="kn">import</span> <span class="n">config</span><span class="p">,</span> <span class="n">execute_event</span>

<span class="n">app_config</span> <span class="o">=</span> <span class="n">config</span><span class="p">(</span><span class="s1">&#39;config/training-pipeline.json&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">execute_event</span><span class="p">(</span><span class="n">app_config</span><span class="p">,</span> <span class="s1">&#39;data.make-sample-data&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span>
                            <span class="n">num_batches</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">batch_span_days</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                            <span class="n">num_customers</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">num_emails</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">num_ips</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2021-05-18 20:24:07,412 | INFO | fraud-poc training data.make-sample-data ALT00617 74682 | Executing: MakeSampleDataJob(path=&#39;./data/raw&#39;, num_batches=2, batch_size=100, batch_span_days=10, num_customers=100, num_emails=100, num_ips=100)... | track.operation_id=test_operation_id | track.request_id=test_request_id | track.request_ts=2021-05-18T20:24:07.412401+00:00
2021-05-18 20:24:08,219 | INFO | fraud-poc training data.make-sample-data ALT00617 74682 | Dask: &lt;Client: &#39;tcp://127.0.0.1:58174&#39; processes=4 threads=8, memory=16.00 GiB&gt; | track.operation_id=test_operation_id | track.request_id=test_request_id | track.request_ts=2021-05-18T20:24:07.412401+00:00
2021-05-18 20:24:08,224 | INFO | fraud-poc training data.make-sample-data ALT00617 74682 | Submitting batch 0... | track.operation_id=test_operation_id | track.request_id=test_request_id | track.request_ts=2021-05-18T20:24:07.412401+00:00
2021-05-18 20:24:08,226 | INFO | fraud-poc training data.make-sample-data ALT00617 74682 | Submitting batch 1... | track.operation_id=test_operation_id | track.request_id=test_request_id | track.request_ts=2021-05-18T20:24:07.412401+00:00
2021-05-18 20:24:08,796 | INFO | fraud-poc training data.make-sample-data ALT00617 74682 | Done batch: ./data/raw/batch00.parquet. | track.operation_id=test_operation_id | track.request_id=test_request_id | track.request_ts=2021-05-18T20:24:07.412401+00:00
2021-05-18 20:24:08,811 | INFO | fraud-poc training data.make-sample-data ALT00617 74682 | Done batch: ./data/raw/batch01.parquet. | track.operation_id=test_operation_id | track.request_id=test_request_id | track.request_ts=2021-05-18T20:24:07.412401+00:00
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>MakeSampleDataJob(path=&#39;./data/raw&#39;, num_batches=2, batch_size=100, batch_span_days=10, num_customers=100, num_emails=100, num_ips=100)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">dask.dataframe</span> <span class="k">as</span> <span class="nn">dd</span>
<span class="n">dd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_id</th>
      <th>order_date</th>
      <th>customer_id</th>
      <th>email</th>
      <th>ip_addr</th>
      <th>location_lat</th>
      <th>location_long</th>
      <th>order_amount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5a699fab-b8b3-4e19-bbc6-0e970ffba031</td>
      <td>2021-05-11 17:35:50+00:00</td>
      <td>5132ccfc-ce47-4f4d-bdb2-f8fface2ab5f</td>
      <td>bad573204742b126622e6a5c090b3769a33a3308</td>
      <td>52d44eb8e3243a1adf9a43b74e0b7629be671277</td>
      <td>-10.835709</td>
      <td>-19.554605</td>
      <td>877.709842</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1452029f-f659-4611-9f8c-5a23fd1626cf</td>
      <td>2021-05-17 13:24:05+00:00</td>
      <td>25817e58-f0f5-4d0a-bc74-6fc00ce9c70d</td>
      <td>1ebd4eae5ff22fff30e8dc152d8571a9ba5774bd</td>
      <td>449e07ab35d65c5a874740bf8e22d2a4d0fbce7a</td>
      <td>-13.531581</td>
      <td>-10.881747</td>
      <td>235.479339</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31510480-2267-430a-a638-2cd42cfc60f4</td>
      <td>2021-05-11 23:12:56+00:00</td>
      <td>c6eb3cd2-93bc-413f-a0e9-61c71ab0d224</td>
      <td>5402e6915b106c264bd2bd7d7194e45d6de83091</td>
      <td>29854c437e114323911562c081daa967fc2418a4</td>
      <td>-11.012069</td>
      <td>-10.141314</td>
      <td>68.890731</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9f461fd9-2ad1-4c61-b600-24af355d8e63</td>
      <td>2021-05-14 00:25:21+00:00</td>
      <td>8a6a7275-c331-48aa-baa6-970014d04963</td>
      <td>da80f9f0a66ba22fc910f9fb6fc7bbbd3d79fab3</td>
      <td>14e11fef153a52f328d803fc07b48905c8a8c31f</td>
      <td>-18.711148</td>
      <td>-12.039022</td>
      <td>444.247712</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9cc8c9aa-e342-4e7a-8269-4ebb7bc0d208</td>
      <td>2021-05-15 04:11:54+00:00</td>
      <td>09da86be-63c3-4265-a799-8fe5efaf270c</td>
      <td>79cdeec4056ed0714127c4c255d9dafa334ee2a7</td>
      <td>ee714f6b18d2b01e2d632f1299d8cb7618099070</td>
      <td>-16.110130</td>
      <td>-13.836294</td>
      <td>955.929156</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

