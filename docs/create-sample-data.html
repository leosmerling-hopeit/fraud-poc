---

title: Title

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_create-sample-data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Create-Sample-Data">Create Sample Data<a class="anchor-link" href="#Create-Sample-Data"> </a></h3><blockquote><p>This module creates batches of random generated orders and saves that to parquet files using Dask</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="OrderRandomSource" class="doc_header"><code>class</code> <code>OrderRandomSource</code><a href="https://github.com/leosmerling/fraud_poc/tree/master/fraud_poc/data/make_sample_data.py#L44" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>OrderRandomSource</code>(<strong><code>days_ago</code></strong>:<code>int</code>, <strong><code>days_span</code></strong>:<code>int</code>, <strong><code>customer_ids</code></strong>:<code>list</code>, <strong><code>emails</code></strong>:<code>list</code>, <strong><code>email_to_customer</code></strong>:<code>list</code>, <strong><code>ips</code></strong>, <strong><code>email_to_ip</code></strong>:<code>list</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="submit_job" class="doc_header"><code>submit_job</code><a href="https://github.com/leosmerling/fraud_poc/tree/master/fraud_poc/data/make_sample_data.py#L121" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>submit_job</code>(<strong><code>payload</code></strong>:<code>None</code>, <strong><code>context</code></strong>:<code>EventContext</code>, <strong><code>num_batches</code></strong>:<code>int</code>=<em><code>12</code></em>, <strong><code>batch_size</code></strong>:<code>int</code>=<em><code>100000</code></em>, <strong><code>batch_span_days</code></strong>:<code>int</code>=<em><code>30</code></em>, <strong><code>num_customers</code></strong>:<code>int</code>=<em><code>10000</code></em>, <strong><code>num_emails</code></strong>:<code>int</code>=<em><code>10000</code></em>, <strong><code>num_ips</code></strong>:<code>int</code>=<em><code>10000</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_batches" class="doc_header"><code>make_batches</code><a href="https://github.com/leosmerling/fraud_poc/tree/master/fraud_poc/data/make_sample_data.py#L128" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_batches</code>(<strong><code>job</code></strong>:<a href="/fraud_poc/jobs#MakeSampleDataJob"><code>MakeSampleDataJob</code></a>, <strong><code>context</code></strong>:<code>EventContext</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Test-from-notebook">Test from notebook<a class="anchor-link" href="#Test-from-notebook"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">hopeit.testing.apps</span> <span class="kn">import</span> <span class="n">config</span><span class="p">,</span> <span class="n">execute_event</span>

<span class="n">app_config</span> <span class="o">=</span> <span class="n">config</span><span class="p">(</span><span class="s1">&#39;config/training-pipeline.json&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">execute_event</span><span class="p">(</span><span class="n">app_config</span><span class="p">,</span> <span class="s1">&#39;data.make-sample-data&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span>
                            <span class="n">num_batches</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">batch_span_days</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                            <span class="n">num_customers</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">num_emails</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">num_ips</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2020-07-07 07:58:55,374 | INFO | fraud-poc 0.0.1 data.make-sample-data leo-legion 9542 | Executing: MakeSampleDataJob(path=&#39;./data/raw&#39;, num_batches=2, batch_size=1000, batch_span_days=10, num_customers=1000, num_emails=1000, num_ips=1000)... | track.operation_id=test_operation_id | track.request_id=test_request_id | track.request_ts=2020-07-07T07:58:55.373982+00:00
2020-07-07 07:58:56,222 | INFO | fraud-poc 0.0.1 data.make-sample-data leo-legion 9542 | Dask: &lt;Client: &#39;tcp://127.0.0.1:35077&#39; processes=4 threads=12, memory=33.54 GB&gt; | track.operation_id=test_operation_id | track.request_id=test_request_id | track.request_ts=2020-07-07T07:58:55.373982+00:00
2020-07-07 07:58:56,246 | INFO | fraud-poc 0.0.1 data.make-sample-data leo-legion 9542 | Submitting batch 0... | track.operation_id=test_operation_id | track.request_id=test_request_id | track.request_ts=2020-07-07T07:58:55.373982+00:00
2020-07-07 07:58:56,255 | INFO | fraud-poc 0.0.1 data.make-sample-data leo-legion 9542 | Submitting batch 1... | track.operation_id=test_operation_id | track.request_id=test_request_id | track.request_ts=2020-07-07T07:58:55.373982+00:00
2020-07-07 07:58:57,429 | INFO | fraud-poc 0.0.1 data.make-sample-data leo-legion 9542 | Done batch: ./data/raw/batch00.parquet. | track.operation_id=test_operation_id | track.request_id=test_request_id | track.request_ts=2020-07-07T07:58:55.373982+00:00
2020-07-07 07:58:57,432 | INFO | fraud-poc 0.0.1 data.make-sample-data leo-legion 9542 | Done batch: ./data/raw/batch01.parquet. | track.operation_id=test_operation_id | track.request_id=test_request_id | track.request_ts=2020-07-07T07:58:55.373982+00:00
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>MakeSampleDataJob(path=&#39;./data/raw&#39;, num_batches=2, batch_size=1000, batch_span_days=10, num_customers=1000, num_emails=1000, num_ips=1000)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">dask.dataframe</span> <span class="k">as</span> <span class="nn">dd</span>
<span class="n">dd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_id</th>
      <th>order_date</th>
      <th>customer_id</th>
      <th>email</th>
      <th>ip_addr</th>
      <th>location_lat</th>
      <th>location_long</th>
      <th>order_amount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>d03d2ac3-e743-4d36-89b3-69ada8bc644f</td>
      <td>2020-07-01 05:56:22+00:00</td>
      <td>d0028e6c-877d-485b-9729-db7d25bb30e9</td>
      <td>0b083a8a6297fb87c3896a8646829e9abdf03586</td>
      <td>481a69203c335d1793b3064588318c2502685b96</td>
      <td>-10.338813</td>
      <td>-11.187772</td>
      <td>560.495050</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1e0fa14e-e4dd-4679-984a-4ff55a45203a</td>
      <td>2020-06-29 03:03:09+00:00</td>
      <td>8b5eadd0-9385-402f-a8de-19280e2f2e25</td>
      <td>9276818c1d9ade25b4f5b8379edff60a02aa3b20</td>
      <td>d4ce28f637554a62f9a2a71a0ebbd4993fe9a78b</td>
      <td>-13.593945</td>
      <td>-11.779278</td>
      <td>952.575210</td>
    </tr>
    <tr>
      <th>2</th>
      <td>034373df-10ab-4c41-afb2-84a2e8b7c2c6</td>
      <td>2020-07-01 01:26:53+00:00</td>
      <td>e8c4e465-0f16-4c7e-9d30-0ce0e4018b90</td>
      <td>765d0eae8a3017bca98ef69c00ef6cf8a9b8f758</td>
      <td>a3c6de1868c82ba38cf50098b4fe884c1ed31f2c</td>
      <td>-12.475382</td>
      <td>-10.575640</td>
      <td>935.767647</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11bc1132-88f5-40bf-9269-664815636ca4</td>
      <td>2020-06-27 11:16:25+00:00</td>
      <td>8392e44d-6cb9-4d6a-8597-025a37b3932e</td>
      <td>41017cdbcf7672f4e112750756280da5410496c5</td>
      <td>216e248199e3d65a12de3a25c355c9856072432c</td>
      <td>-13.095234</td>
      <td>-11.961017</td>
      <td>463.160127</td>
    </tr>
    <tr>
      <th>4</th>
      <td>c92cb30b-991f-4568-a747-f4f6165f6e3b</td>
      <td>2020-07-04 11:01:48+00:00</td>
      <td>d2112e14-b65b-460d-b525-657b535aa05a</td>
      <td>efa842b9609a522ec496262834937404fc1029d4</td>
      <td>c2b9c97ed4a461ab3cf70cd57176bd0308bff910</td>
      <td>-17.466511</td>
      <td>-13.253921</td>
      <td>794.789987</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

