---

title: Title

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 04_training-data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Training-Data-Preparation">Training Data Preparation<a class="anchor-link" href="#Training-Data-Preparation"> </a></h3><blockquote><p>This module reads features computed on customer_id and email, merges both datasets, obtain <code>is_fraud</code> label for orders and creates two dataset that are suitable to train the model:&gt;1) Sampled: a dataset that contains all transactions marked as fraud, plus a subsample of the non fraud orders, in order to obtain a less-imbalanced dataset and train faster&gt; 2) Validation:a dataset containing only most recent orders, containing all fraud and non fraud transactions to be use as a final validation for the trained model.</p>
</blockquote>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="run" class="doc_header"><code>run</code><a href="https://github.com/leosmerling/fraud_poc/tree/master/fraud_poc/data/training_data.py#L63" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>run</code>(<strong><code>job</code></strong>:<a href="/fraud_poc/jobs#FeatureCalcJob"><code>FeatureCalcJob</code></a>, <strong><code>context</code></strong>:<code>EventContext</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Test-from-notebook">Test from notebook<a class="anchor-link" href="#Test-from-notebook"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">hopeit.testing.apps</span> <span class="kn">import</span> <span class="n">config</span><span class="p">,</span> <span class="n">execute_event</span>

<span class="n">app_config</span> <span class="o">=</span> <span class="n">config</span><span class="p">(</span><span class="s1">&#39;config/training-pipeline.json&#39;</span><span class="p">)</span>
<span class="n">job</span> <span class="o">=</span> <span class="n">FeatureCalcJob</span><span class="p">(</span><span class="n">sources</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;customer_id&#39;</span><span class="p">:</span> <span class="s1">&#39;./data/partitioned/customer_id/&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;./data/partitioned/email&#39;</span><span class="p">},</span> 
                     <span class="n">features</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;customer_id&#39;</span><span class="p">:</span> <span class="s1">&#39;./data/features/customer_id/&#39;</span><span class="p">,</span> <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;./data/features/email/&#39;</span><span class="p">})</span>
<span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">execute_event</span><span class="p">(</span><span class="n">app_config</span><span class="p">,</span> <span class="s1">&#39;data.training-data&#39;</span><span class="p">,</span> <span class="n">job</span><span class="p">)</span>
<span class="n">result</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>2020-07-07 22:36:58,442 | INFO | fraud-poc 0.0.1-training data.training-data leo-legion 18704 | Saving sampled training dataset to ./data/training/sampled/... | track.operation_id=test_operation_id | track.request_id=test_request_id | track.request_ts=2020-07-07T22:36:57.211612+00:00 | stream.name= | stream.msg_id= | stream.consumer_group=
2020-07-07 22:37:43,979 | INFO | fraud-poc 0.0.1-training data.training-data leo-legion 18704 | Saving weighted validation dataset to ./data/training/validation/... | track.operation_id=test_operation_id | track.request_id=test_request_id | track.request_ts=2020-07-07T22:36:57.211612+00:00 | stream.name= | stream.msg_id= | stream.consumer_group=
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>TrainingDataJob(sources={&#39;customer_id&#39;: &#39;./data/features/customer_id/&#39;, &#39;email&#39;: &#39;./data/features/email/&#39;}, sampled=&#39;./data/training/sampled/&#39;, validation=&#39;./data/training/validation/&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">sampled</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Task was destroyed but it is pending!
task: &lt;Task pending name=&#39;Task-625&#39; coro=&lt;HTTP1ServerConnection._server_request_loop() running at /opt/dev/anaconda3/envs/dask/lib/python3.8/site-packages/tornado/http1connection.py:817&gt; wait_for=&lt;Future pending cb=[&lt;TaskWakeupMethWrapper object at 0x7fb0c8c25af0&gt;()]&gt; cb=[IOLoop.add_future.&lt;locals&gt;.&lt;lambda&gt;() at /opt/dev/anaconda3/envs/dask/lib/python3.8/site-packages/tornado/ioloop.py:690]&gt;
Task was destroyed but it is pending!
task: &lt;Task pending name=&#39;Task-630&#39; coro=&lt;HTTP1ServerConnection._server_request_loop() running at /opt/dev/anaconda3/envs/dask/lib/python3.8/site-packages/tornado/http1connection.py:817&gt; wait_for=&lt;Future pending cb=[&lt;TaskWakeupMethWrapper object at 0x7fb0a3fa0a60&gt;()]&gt; cb=[IOLoop.add_future.&lt;locals&gt;.&lt;lambda&gt;() at /opt/dev/anaconda3/envs/dask/lib/python3.8/site-packages/tornado/ioloop.py:690]&gt;
Task was destroyed but it is pending!
task: &lt;Task pending name=&#39;Task-631&#39; coro=&lt;HTTP1ServerConnection._server_request_loop() running at /opt/dev/anaconda3/envs/dask/lib/python3.8/site-packages/tornado/http1connection.py:817&gt; wait_for=&lt;Future pending cb=[&lt;TaskWakeupMethWrapper object at 0x7fb0a3f29ac0&gt;()]&gt; cb=[IOLoop.add_future.&lt;locals&gt;.&lt;lambda&gt;() at /opt/dev/anaconda3/envs/dask/lib/python3.8/site-packages/tornado/ioloop.py:690]&gt;
Task was destroyed but it is pending!
task: &lt;Task pending name=&#39;Task-632&#39; coro=&lt;HTTP1ServerConnection._server_request_loop() running at /opt/dev/anaconda3/envs/dask/lib/python3.8/site-packages/tornado/http1connection.py:817&gt; wait_for=&lt;Future pending cb=[&lt;TaskWakeupMethWrapper object at 0x7fb0a3fa0e50&gt;()]&gt; cb=[IOLoop.add_future.&lt;locals&gt;.&lt;lambda&gt;() at /opt/dev/anaconda3/envs/dask/lib/python3.8/site-packages/tornado/ioloop.py:690]&gt;
Task was destroyed but it is pending!
task: &lt;Task pending name=&#39;Task-633&#39; coro=&lt;HTTP1ServerConnection._server_request_loop() running at /opt/dev/anaconda3/envs/dask/lib/python3.8/site-packages/tornado/http1connection.py:817&gt; wait_for=&lt;Future pending cb=[&lt;TaskWakeupMethWrapper object at 0x7fb0a3fa0b20&gt;()]&gt; cb=[IOLoop.add_future.&lt;locals&gt;.&lt;lambda&gt;() at /opt/dev/anaconda3/envs/dask/lib/python3.8/site-packages/tornado/ioloop.py:690]&gt;
Task was destroyed but it is pending!
task: &lt;Task pending name=&#39;Task-645&#39; coro=&lt;RequestHandler._execute() running at /opt/dev/anaconda3/envs/dask/lib/python3.8/site-packages/tornado/web.py:1703&gt; wait_for=&lt;Future pending cb=[&lt;TaskWakeupMethWrapper object at 0x7fb0a4114190&gt;()]&gt; cb=[_HandlerDelegate.execute.&lt;locals&gt;.&lt;lambda&gt;() at /opt/dev/anaconda3/envs/dask/lib/python3.8/site-packages/tornado/web.py:2333]&gt;
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_amount</th>
      <th>num_email_by_customer_id</th>
      <th>num_ip_addr_by_customer_id</th>
      <th>same_email_by_customer_id</th>
      <th>same_ip_addr_by_customer_id</th>
      <th>known_email_by_customer_id</th>
      <th>known_ip_addr_by_customer_id</th>
      <th>order_amount_mean_by_customer_id</th>
      <th>order_amount_std_by_customer_id</th>
      <th>order_amount_min_by_customer_id</th>
      <th>...</th>
      <th>known_customer_id_by_email</th>
      <th>order_amount_mean_by_email</th>
      <th>order_amount_std_by_email</th>
      <th>order_amount_min_by_email</th>
      <th>order_amount_max_by_email</th>
      <th>order_amount_sum_by_email</th>
      <th>is_fraud</th>
      <th>sample</th>
      <th>elapsed_wgt</th>
      <th>validation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1.072089e+06</td>
      <td>1.072089e+06</td>
      <td>1.072089e+06</td>
      <td>1.072089e+06</td>
      <td>1.072089e+06</td>
      <td>1.072089e+06</td>
      <td>1.072089e+06</td>
      <td>1.072089e+06</td>
      <td>1.072089e+06</td>
      <td>1.072089e+06</td>
      <td>...</td>
      <td>1.072089e+06</td>
      <td>1.072089e+06</td>
      <td>1.072089e+06</td>
      <td>1.072089e+06</td>
      <td>1.072089e+06</td>
      <td>1.072089e+06</td>
      <td>1.072089e+06</td>
      <td>1072089.0</td>
      <td>1.072089e+06</td>
      <td>1.072089e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>5.267080e+02</td>
      <td>2.160165e+00</td>
      <td>3.119257e+00</td>
      <td>5.705758e-01</td>
      <td>4.602976e-01</td>
      <td>9.707590e-01</td>
      <td>8.614052e-01</td>
      <td>5.012814e+02</td>
      <td>2.656489e+02</td>
      <td>1.001119e+02</td>
      <td>...</td>
      <td>9.895568e-01</td>
      <td>5.018918e+02</td>
      <td>2.634956e+02</td>
      <td>1.052752e+02</td>
      <td>8.979406e+02</td>
      <td>4.789087e+03</td>
      <td>8.804055e-01</td>
      <td>1.0</td>
      <td>9.901491e-01</td>
      <td>1.927834e-01</td>
    </tr>
    <tr>
      <th>std</th>
      <td>2.759189e+02</td>
      <td>1.013540e+00</td>
      <td>1.369770e+00</td>
      <td>4.949942e-01</td>
      <td>4.984215e-01</td>
      <td>1.684815e-01</td>
      <td>3.455234e-01</td>
      <td>9.665022e+01</td>
      <td>5.215631e+01</td>
      <td>9.980408e+01</td>
      <td>...</td>
      <td>1.016568e-01</td>
      <td>9.983118e+01</td>
      <td>5.651710e+01</td>
      <td>1.096340e+02</td>
      <td>1.074631e+02</td>
      <td>1.212657e+03</td>
      <td>3.244870e-01</td>
      <td>0.0</td>
      <td>5.692438e-03</td>
      <td>3.944846e-01</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.560899e-03</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.001237e+00</td>
      <td>0.000000e+00</td>
      <td>2.271392e-04</td>
      <td>...</td>
      <td>0.000000e+00</td>
      <td>3.408705e-02</td>
      <td>0.000000e+00</td>
      <td>2.271392e-04</td>
      <td>3.408705e-02</td>
      <td>3.408705e-02</td>
      <td>0.000000e+00</td>
      <td>1.0</td>
      <td>9.802699e-01</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.959992e+02</td>
      <td>1.000000e+00</td>
      <td>2.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>4.384200e+02</td>
      <td>2.375031e+02</td>
      <td>3.050219e+01</td>
      <td>...</td>
      <td>1.000000e+00</td>
      <td>4.383146e+02</td>
      <td>2.362462e+02</td>
      <td>3.125854e+01</td>
      <td>8.618774e+02</td>
      <td>4.216201e+03</td>
      <td>1.000000e+00</td>
      <td>1.0</td>
      <td>9.852614e-01</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5.319706e+02</td>
      <td>2.000000e+00</td>
      <td>3.000000e+00</td>
      <td>1.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>5.021227e+02</td>
      <td>2.701232e+02</td>
      <td>7.207299e+01</td>
      <td>...</td>
      <td>1.000000e+00</td>
      <td>5.028616e+02</td>
      <td>2.695697e+02</td>
      <td>7.425120e+01</td>
      <td>9.296629e+02</td>
      <td>4.922503e+03</td>
      <td>1.000000e+00</td>
      <td>1.0</td>
      <td>9.901895e-01</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>7.665151e+02</td>
      <td>3.000000e+00</td>
      <td>4.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>5.661961e+02</td>
      <td>3.000172e+02</td>
      <td>1.407146e+02</td>
      <td>...</td>
      <td>1.000000e+00</td>
      <td>5.675166e+02</td>
      <td>2.998108e+02</td>
      <td>1.457638e+02</td>
      <td>9.703124e+02</td>
      <td>5.584035e+03</td>
      <td>1.000000e+00</td>
      <td>1.0</td>
      <td>9.951112e-01</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>max</th>
      <td>9.999995e+02</td>
      <td>7.000000e+00</td>
      <td>1.000000e+01</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>9.999918e+02</td>
      <td>4.982714e+02</td>
      <td>9.999918e+02</td>
      <td>...</td>
      <td>1.000000e+00</td>
      <td>9.999918e+02</td>
      <td>4.982714e+02</td>
      <td>9.999918e+02</td>
      <td>9.999995e+02</td>
      <td>8.915618e+03</td>
      <td>1.000000e+00</td>
      <td>1.0</td>
      <td>9.999744e-01</td>
      <td>1.000000e+00</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 24 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">validation</span><span class="p">)</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_amount</th>
      <th>num_email_by_customer_id</th>
      <th>num_ip_addr_by_customer_id</th>
      <th>same_email_by_customer_id</th>
      <th>same_ip_addr_by_customer_id</th>
      <th>known_email_by_customer_id</th>
      <th>known_ip_addr_by_customer_id</th>
      <th>order_amount_mean_by_customer_id</th>
      <th>order_amount_std_by_customer_id</th>
      <th>order_amount_min_by_customer_id</th>
      <th>...</th>
      <th>order_amount_mean_by_email</th>
      <th>order_amount_std_by_email</th>
      <th>order_amount_min_by_email</th>
      <th>order_amount_max_by_email</th>
      <th>order_amount_sum_by_email</th>
      <th>is_fraud</th>
      <th>sample</th>
      <th>elapsed_wgt</th>
      <th>validation</th>
      <th>fold</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>229899.000000</td>
      <td>229899.000000</td>
      <td>229899.000000</td>
      <td>229899.000000</td>
      <td>229899.000000</td>
      <td>229899.000000</td>
      <td>229899.000000</td>
      <td>229899.000000</td>
      <td>229899.000000</td>
      <td>229899.000000</td>
      <td>...</td>
      <td>229899.000000</td>
      <td>229899.000000</td>
      <td>229899.000000</td>
      <td>229899.000000</td>
      <td>229899.000000</td>
      <td>229899.000000</td>
      <td>229899.000000</td>
      <td>229899.000000</td>
      <td>229899.0</td>
      <td>229899.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>499.575716</td>
      <td>2.157073</td>
      <td>3.111566</td>
      <td>0.572934</td>
      <td>0.464047</td>
      <td>0.972679</td>
      <td>0.867242</td>
      <td>499.597151</td>
      <td>267.026925</td>
      <td>97.229817</td>
      <td>...</td>
      <td>499.416451</td>
      <td>264.900245</td>
      <td>101.846350</td>
      <td>897.765100</td>
      <td>4777.521732</td>
      <td>0.785497</td>
      <td>0.892153</td>
      <td>0.990291</td>
      <td>1.0</td>
      <td>5.000183</td>
    </tr>
    <tr>
      <th>std</th>
      <td>288.783726</td>
      <td>1.012125</td>
      <td>1.365872</td>
      <td>0.494653</td>
      <td>0.498707</td>
      <td>0.163017</td>
      <td>0.339314</td>
      <td>96.555412</td>
      <td>51.819866</td>
      <td>97.441246</td>
      <td>...</td>
      <td>99.781962</td>
      <td>55.895181</td>
      <td>106.629882</td>
      <td>107.388765</td>
      <td>1202.931560</td>
      <td>0.410478</td>
      <td>0.310188</td>
      <td>0.005683</td>
      <td>0.0</td>
      <td>3.162667</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.004208</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.457344</td>
      <td>0.000000</td>
      <td>0.000227</td>
      <td>...</td>
      <td>0.295380</td>
      <td>0.000000</td>
      <td>0.000227</td>
      <td>0.295380</td>
      <td>0.295380</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.980270</td>
      <td>1.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>254.207715</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>437.617167</td>
      <td>239.067854</td>
      <td>29.753422</td>
      <td>...</td>
      <td>435.394575</td>
      <td>238.285830</td>
      <td>30.483997</td>
      <td>862.305111</td>
      <td>4199.806490</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.985520</td>
      <td>1.0</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>505.215247</td>
      <td>2.000000</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>501.715618</td>
      <td>271.648605</td>
      <td>70.648778</td>
      <td>...</td>
      <td>500.704623</td>
      <td>271.126161</td>
      <td>71.581809</td>
      <td>930.681119</td>
      <td>4909.946848</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.990526</td>
      <td>1.0</td>
      <td>5.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>755.731631</td>
      <td>3.000000</td>
      <td>4.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>565.428195</td>
      <td>301.652860</td>
      <td>137.977865</td>
      <td>...</td>
      <td>565.241917</td>
      <td>301.407646</td>
      <td>141.064595</td>
      <td>970.713671</td>
      <td>5579.990289</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.995357</td>
      <td>1.0</td>
      <td>8.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>999.996485</td>
      <td>7.000000</td>
      <td>10.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>997.396879</td>
      <td>498.271440</td>
      <td>997.396879</td>
      <td>...</td>
      <td>997.812768</td>
      <td>498.271440</td>
      <td>997.812768</td>
      <td>999.999489</td>
      <td>8880.975814</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.999974</td>
      <td>1.0</td>
      <td>10.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 25 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">read_parquet</span><span class="p">(</span><span class="s1">&#39;./data/training/validation/&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">is_fraud</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_id</th>
      <th>order_date</th>
      <th>email</th>
      <th>ip_addr</th>
      <th>order_amount</th>
      <th>customer_id</th>
      <th>email_by_customer_id</th>
      <th>ip_addr_by_customer_id</th>
      <th>num_email_by_customer_id</th>
      <th>num_ip_addr_by_customer_id</th>
      <th>...</th>
      <th>order_amount_min_by_email</th>
      <th>order_amount_max_by_email</th>
      <th>order_amount_sum_by_email</th>
      <th>order_amount_by_email</th>
      <th>is_fraud</th>
      <th>sample</th>
      <th>now</th>
      <th>elapsed_wgt</th>
      <th>validation</th>
      <th>fold</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>55</th>
      <td>eef0e5b1-9898-4c9a-8e92-81bac714a870</td>
      <td>2020-03-18 06:20:25+00:00</td>
      <td>afe4b272a5def9d9b3cd9d8ac9b6136bbe90ffe9</td>
      <td>c7ee6b54b39b1b5edefa3aa85d24665ed8feadd5</td>
      <td>547.086027</td>
      <td>002d6c90-2680-494a-b65e-c969c48277c8</td>
      <td>['afe4b272a5def9d9b3cd9d8ac9b6136bbe90ffe9', '...</td>
      <td>['c7ee6b54b39b1b5edefa3aa85d24665ed8feadd5', '...</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>46.870327</td>
      <td>698.002805</td>
      <td>4037.924935</td>
      <td>[259.83261171744243, 46.870327361839934, 630.1...</td>
      <td>0</td>
      <td>0</td>
      <td>2020-07-08 10:40:24.712622+00:00</td>
      <td>0.993902</td>
      <td>1</td>
      <td>9</td>
    </tr>
    <tr>
      <th>78</th>
      <td>442b9d8c-fc9e-40a9-ae6d-442b8f222a73</td>
      <td>2020-05-30 14:43:39+00:00</td>
      <td>414a4d901fb5d28d0b794c0b145430a1b9eceffa</td>
      <td>504395f5e6b0426c6e5917bd18a287abedb7d7f8</td>
      <td>489.182172</td>
      <td>003454f4-d2cc-4845-8256-15a7f639becc</td>
      <td>['414a4d901fb5d28d0b794c0b145430a1b9eceffa', '...</td>
      <td>['504395f5e6b0426c6e5917bd18a287abedb7d7f8', '...</td>
      <td>2</td>
      <td>2</td>
      <td>...</td>
      <td>18.227239</td>
      <td>811.657061</td>
      <td>4416.252078</td>
      <td>[510.21130492364875, 155.86290494965394, 491.4...</td>
      <td>0</td>
      <td>1</td>
      <td>2020-07-08 10:40:24.712622+00:00</td>
      <td>0.997893</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>148</th>
      <td>d01377a8-2b7f-45d9-bedb-d32a39af893e</td>
      <td>2019-11-20 06:07:59+00:00</td>
      <td>bf8edae2c642ce476fba0404cd48ebd306a9e331</td>
      <td>331e631a8879c97c23fad416f8a96a9685f5186d</td>
      <td>565.939878</td>
      <td>005151c1-316c-4b11-a36e-16c495bc5528</td>
      <td>['7fb135d0fbc29f0fe2b64fcab2ed929928f62aaf', '...</td>
      <td>['f5f788c173e5c89122cb3502e2c1205dd00aa52d', '...</td>
      <td>2</td>
      <td>4</td>
      <td>...</td>
      <td>35.432090</td>
      <td>800.632491</td>
      <td>3813.130451</td>
      <td>[102.4452576754118, 305.81444470653696, 468.17...</td>
      <td>0</td>
      <td>0</td>
      <td>2020-07-08 10:40:24.712622+00:00</td>
      <td>0.987391</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>300</th>
      <td>e52cd433-60fe-428c-a027-1b86f084138b</td>
      <td>2019-11-20 21:06:08+00:00</td>
      <td>031a29720199b6e87af8abe6ac60d9725b920a88</td>
      <td>199659be876d5da3b23132215225dcef9b8e64a0</td>
      <td>969.332707</td>
      <td>00d8e94f-f19f-4d6d-b225-ece8ca2e80a7</td>
      <td>['031a29720199b6e87af8abe6ac60d9725b920a88', '...</td>
      <td>['199659be876d5da3b23132215225dcef9b8e64a0', '...</td>
      <td>5</td>
      <td>6</td>
      <td>...</td>
      <td>142.240825</td>
      <td>969.332707</td>
      <td>5138.391860</td>
      <td>[228.43338205886343, 315.28410476759495, 641.1...</td>
      <td>0</td>
      <td>1</td>
      <td>2020-07-08 10:40:24.712622+00:00</td>
      <td>0.987425</td>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <th>354</th>
      <td>ccb272c0-4c82-4719-ae5a-bcd6cda09962</td>
      <td>2020-05-17 21:21:06+00:00</td>
      <td>daf294993afcba23204d924db0139ecb1600f3ac</td>
      <td>3750a44f6dcd89f0849caf09d12ad25e0a55305c</td>
      <td>284.537458</td>
      <td>00f9c62c-572d-46d1-b04f-bea893fbe0eb</td>
      <td>['ac35cd18ba6c709b33cbb1da170a4405fb2836cf', '...</td>
      <td>['826a6db07e5f5f62ba0f3263ff5b62a773573d77', '...</td>
      <td>5</td>
      <td>6</td>
      <td>...</td>
      <td>116.431429</td>
      <td>946.398526</td>
      <td>4239.615681</td>
      <td>[208.65553859182018, 298.96564343692825, 650.7...</td>
      <td>0</td>
      <td>0</td>
      <td>2020-07-08 10:40:24.712622+00:00</td>
      <td>0.997202</td>
      <td>1</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 39 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

